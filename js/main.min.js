"use strict";function parseGPX(t){for(var e=[],a=t.getElementsByTagName("trkpt"),l=0;l<a.length;l+=3){var n=a[l],r={lat:parseFloat(n.getAttribute("lat")),lon:parseFloat(n.getAttribute("lon"))};if(0!=r.lat&&0!=r.lon){var o=transformFromWGSToGCJ(r.lon,r.lat),s={lat:o.lat,lon:o.lng};e.push(s)}}return e}$(document).ready(function(){var t=new AMap.Map("map-container",{zoom:12,center:[121.433951,31.199027],mapStyle:"dark",features:["bg","road"]}),e=0;$("#clear").on("click",function(){t.clearMap(),e=0,$("#msg").html("")}),$("#file").on("change",function(){e+=this.files.length;for(var a=0;a<this.files.length;a++){var l=this.files[a],n=window.URL.createObjectURL(l);$.ajax({type:"GET",url:n,dataType:"xml",success:function(a){var l=parseGPX(a);$("#msg").html("处理完成，累计绘制"+e+"条记录"),l.length>0&&t.setCenter(new AMap.LngLat(l[0].lon,l[0].lat));for(var n=new Array,r=0;r<l.length;r++){n.push(new AMap.LngLat(l[r].lon,l[r].lat));new AMap.Polyline({map:t,path:n,isOutline:!1,outlineColor:"#ff0000",strokeColor:"#00ff00",strokeOpacity:.35,strokeWeight:4,strokeStyle:"solid"})}}}),$("#msg").html("处理中...")}})});